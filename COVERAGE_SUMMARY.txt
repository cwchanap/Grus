CODEBASE TEST COVERAGE SUMMARY
==============================

TOTAL SOURCE FILES: 82
TOTAL TEST FILES: 36
OVERALL COVERAGE: 21% (17 files with tests, 65 files without)

========== CRITICAL UNTESTED FILES (MUST ADDRESS) ==========

TIER 1 - ZERO TESTS, HIGH RISK:
  1. lib/core/websocket-handler.ts (683 lines) - All real-time communication
  2. lib/core/game-registry.ts (64 lines) - Plugin registration system
  3. routes/api/websocket.ts - WebSocket route entry point
  4. lib/games/poker/poker-utils.ts - Poker utility functions
  5. lib/auth/auth-utils.ts - Authentication utilities
  6. lib/offline-manager.ts - Offline functionality
  7. lib/config.ts - Configuration management
  8. lib/utils.ts - General utilities
  9. lib/error-messages.ts - Error message definitions

TIER 1 - GAME LOGIC GAPS:
  10. lib/games/poker/poker-engine.ts (385 lines) - Only 10% tested
  11. lib/games/drawing/drawing-engine.ts (383 lines) - No unit tests

TIER 2 - API GAPS (No dedicated tests):
  12. routes/api/admin/cleanup-rooms.ts
  13. routes/api/rooms/cleanup.ts
  14. routes/api/health.ts
  15. routes/api/games.ts
  16. routes/api/joke.ts
  17. routes/api/auth/* (7 files) - Only E2E tested, no unit tests

TIER 2 - COMPONENT GAPS:
  18-22. islands/games/poker/* (5 files) - Poker UI components
  23-31. islands/* modal components (Create, Join, Settings, etc.)
  32-39. components/* (7 files) - Reusable components

========== PARTIALLY TESTED FILES ==========

lib/core/room-manager.ts (526 lines) - 4/10 methods tested
  Tests: lib/__tests__/room-manager-private.test.ts, room-manager-leave.test.ts
  Missing: cleanup, active rooms with cleanup, purge operations

lib/db/kv-room-service.ts - Room CRUD operations tested
  Tests: lib/db/__tests__/kv-room-service-private.test.ts
  
lib/db/kv-service.ts (100+ lines) - Tested
  Tests: lib/db/__tests__/kv-service.test.ts

lib/games/drawing/* - Partially tested
  Tests: islands/__tests__/DrawingBoard.test.tsx, DrawingEngine.test.tsx
  Missing: Unit tests for drawing-engine.ts game logic

routes/api/rooms.ts - GET/POST tested
  Tests: routes/__tests__/api-rooms-private.test.ts, api-integration.test.ts
  Missing: Edge cases, error handling

islands/core/ChatRoom.tsx - Component tested
  Tests: islands/__tests__/ChatRoom.test.tsx, ChatRoom.integration.test.tsx

========== FULLY TESTED FILES ==========

lib/__tests__/drawing-utils.test.ts
lib/games/poker/__tests__/poker-engine-player.test.ts (player management only)
islands/__tests__/Scoreboard.test.tsx
islands/__tests__/Scoreboard.integration.test.tsx
components/__tests__/GameSettingsModal.test.tsx

========== FILE LOCATIONS BY DIRECTORY ==========

lib/core/ (Critical - 25% covered):
  /home/user/Grus/lib/core/room-manager.ts (PARTIAL)
  /home/user/Grus/lib/core/websocket-handler.ts (UNTESTED - CRITICAL)
  /home/user/Grus/lib/core/game-engine.ts (UNTESTED)
  /home/user/Grus/lib/core/game-registry.ts (UNTESTED - CRITICAL)

lib/db/ (67% covered):
  /home/user/Grus/lib/db/kv-room-service.ts (PARTIAL)
  /home/user/Grus/lib/db/kv-service.ts (TESTED)
  /home/user/Grus/lib/db/index.ts
  /home/user/Grus/lib/database-factory.ts (UNTESTED)

lib/games/ (25% covered):
  /home/user/Grus/lib/games/drawing/drawing-engine.ts (UNTESTED - HIGH PRIORITY)
  /home/user/Grus/lib/games/drawing/drawing-utils.ts (TESTED)
  /home/user/Grus/lib/games/poker/poker-engine.ts (UNTESTED - CRITICAL GAP)
  /home/user/Grus/lib/games/poker/poker-utils.ts (UNTESTED)

routes/api/ (18% covered):
  /home/user/Grus/routes/api/rooms.ts (PARTIAL)
  /home/user/Grus/routes/api/rooms/[id]/join.ts (PARTIAL)
  /home/user/Grus/routes/api/rooms/[id]/leave.ts (PARTIAL)
  /home/user/Grus/routes/api/websocket.ts (UNTESTED - CRITICAL)
  /home/user/Grus/routes/api/admin/cleanup-rooms.ts (UNTESTED)
  /home/user/Grus/routes/api/rooms/cleanup.ts (UNTESTED)
  /home/user/Grus/routes/api/auth/*.ts (7 files - UNTESTED)
  /home/user/Grus/routes/api/health.ts (UNTESTED)
  /home/user/Grus/routes/api/games.ts (UNTESTED)
  /home/user/Grus/routes/api/joke.ts (UNTESTED)

islands/ (27% covered):
  Core Islands:
    /home/user/Grus/islands/core/ChatRoom.tsx (TESTED)
    /home/user/Grus/islands/core/MainLobby.tsx (PARTIAL - E2E only)
    /home/user/Grus/islands/core/GameLobby.tsx (UNTESTED)
    /home/user/Grus/islands/core/MainLobbyWithAuth.tsx (UNTESTED)
  
  Drawing Islands:
    /home/user/Grus/islands/games/drawing/DrawingBoard.tsx (TESTED)
    /home/user/Grus/islands/games/drawing/DrawingEngine.tsx (TESTED)
  
  Poker Islands (ALL UNTESTED):
    /home/user/Grus/islands/games/poker/PokerTable.tsx
    /home/user/Grus/islands/games/poker/PokerControls.tsx
    /home/user/Grus/islands/games/poker/PokerPlayer.tsx
  
  Modal Islands (ALL UNTESTED):
    /home/user/Grus/islands/CreateRoomModal.tsx
    /home/user/Grus/islands/JoinRoomModal.tsx
    /home/user/Grus/islands/GameSettingsWrapper.tsx
  
  UI Islands:
    /home/user/Grus/islands/Scoreboard.tsx (TESTED)
    /home/user/Grus/islands/RoomHeader.tsx (UNTESTED)
    /home/user/Grus/islands/LeaveRoomButton.tsx (UNTESTED)
    /home/user/Grus/islands/LoginForm.tsx (UNTESTED)
    /home/user/Grus/islands/SignupForm.tsx (UNTESTED)
    /home/user/Grus/islands/AvatarModal.tsx (UNTESTED)
    /home/user/Grus/islands/UserProfile.tsx (UNTESTED)
    /home/user/Grus/islands/Toast.tsx (UNTESTED)
    /home/user/Grus/islands/Counter.tsx (UNTESTED)
    /home/user/Grus/islands/PokerRoom.tsx (UNTESTED)

components/ (7% covered):
  /home/user/Grus/components/GameSettingsModal.tsx (TESTED)
  /home/user/Grus/components/Button.tsx (UNTESTED)
  /home/user/Grus/components/ErrorBoundary.tsx (UNTESTED)
  /home/user/Grus/components/ConnectionStatus.tsx (UNTESTED)
  /home/user/Grus/components/MobileOptimized.tsx (UNTESTED)
  /home/user/Grus/components/MobileDrawingTools.tsx (UNTESTED)
  /home/user/Grus/components/ShadcnDemo.tsx (UNTESTED - demo)
  /home/user/Grus/components/ui/* (7 files - UI library, lower priority)

lib/utils (0% covered):
  /home/user/Grus/lib/config.ts (UNTESTED)
  /home/user/Grus/lib/utils.ts (UNTESTED)
  /home/user/Grus/lib/error-messages.ts (UNTESTED)
  /home/user/Grus/lib/auth/auth-utils.ts (UNTESTED)
  /home/user/Grus/lib/auth/prisma-client.ts (UNTESTED)
  /home/user/Grus/lib/offline-manager.ts (UNTESTED)

========== EXISTING TEST FILES ==========

Unit Tests:
  /home/user/Grus/lib/__tests__/room-manager-private.test.ts
  /home/user/Grus/lib/__tests__/room-manager-leave.test.ts
  /home/user/Grus/lib/__tests__/drawing-utils.test.ts
  /home/user/Grus/lib/__tests__/test-room-manager.ts (helper)
  /home/user/Grus/lib/db/__tests__/kv-service.test.ts
  /home/user/Grus/lib/db/__tests__/kv-room-service-private.test.ts
  /home/user/Grus/lib/db/__tests__/updatePlayer.test.ts
  /home/user/Grus/lib/db/__tests__/database-service.test.ts
  /home/user/Grus/lib/games/poker/__tests__/poker-engine-player.test.ts
  /home/user/Grus/routes/__tests__/api-rooms-private.test.ts
  /home/user/Grus/routes/__tests__/api-integration.test.ts
  /home/user/Grus/lib/database-service.test.ts

Component Tests:
  /home/user/Grus/islands/__tests__/ChatRoom.test.tsx
  /home/user/Grus/islands/__tests__/ChatRoom.integration.test.tsx
  /home/user/Grus/islands/__tests__/DrawingBoard.test.tsx
  /home/user/Grus/islands/__tests__/DrawingBoard.integration.test.tsx
  /home/user/Grus/islands/__tests__/DrawingEngine.test.tsx
  /home/user/Grus/islands/__tests__/Scoreboard.test.tsx
  /home/user/Grus/islands/__tests__/Scoreboard.integration.test.tsx
  /home/user/Grus/islands/__tests__/component-integration.test.tsx
  /home/user/Grus/islands/__tests__/end-to-end.integration.test.tsx
  /home/user/Grus/components/__tests__/GameSettingsModal.test.tsx

E2E Tests (15 files):
  /home/user/Grus/tests/e2e/smoke.test.ts
  /home/user/Grus/tests/e2e/authentication.test.ts
  /home/user/Grus/tests/e2e/game-flow.test.ts
  /home/user/Grus/tests/e2e/drawing-functionality.test.ts
  /home/user/Grus/tests/e2e/poker-room-creation.test.ts
  /home/user/Grus/tests/e2e/room-management.test.ts
  /home/user/Grus/tests/e2e/websocket-realtime.test.ts
  ... and 8 more E2E tests

Integration Tests:
  /home/user/Grus/tests/integration/poker-room-api.test.ts

========== RECOMMENDATIONS BY PHASE ==========

PHASE 1 (IMMEDIATE - 2-3 weeks):
  Priority 1: WebSocket handler (50-60 new tests)
  Priority 2: Game registry (10-15 new tests)
  Priority 3: Complete poker engine tests (30-40 new tests)
  Priority 4: Drawing engine unit tests (30-40 new tests)

PHASE 2 (1-2 weeks):
  Priority 1: Database operations completion (20-30 new tests)
  Priority 2: Room cleanup operations (15-20 new tests)
  Priority 3: Authentication endpoints (25-35 new tests)

PHASE 3 (1-2 weeks):
  Priority 1: Poker UI components (20-30 new tests)
  Priority 2: Modal components (20-25 new tests)
  Priority 3: Utility components (15-20 new tests)

PHASE 4 (1 week):
  Priority 1: Utility functions (15-20 new tests)
  Priority 2: Config/auth utils (15-25 new tests)

========== ESTIMATED IMPACT ==========

Estimated Untested LOC: ~4,200 lines
Estimated New Tests Needed: 350-450 tests
Priority Tests (Phase 1): ~130-155 tests

